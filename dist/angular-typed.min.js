angular.module("angular-typed",[]).directive("typed",function($log,$timeout,$q){function _link(scope,elem,attrs){function newLine(first){var line=angular.element(document.createElement("span")).addClass("typed-line");first?elem.prepend(line):elem.append(line),elem=line}function backspace(text,currPos){var delay=Math.round(70*Math.random())+backSpeed;$timeout(function(){if(0==currPos){if(startAt<strings.length-1)return startAt++,typeText(strings[startAt],0);console.log("all strings finished")}else{var nextPos=currPos-1,string=text.substr(0,nextPos);elem.text(string),backspace(text,nextPos)}},delay)}function typeText(text,currPos){var delay=Math.round(70*Math.random())+typeSpeed;$timeout(function(){if(currPos==text.length)if(startAt==strings.length-1){if(endBackspace&&backspace(text,currPos),angular.isFunction(scope.endCallback))return scope.$apply(scope.endCallback())}else removeLine?backspace(text,currPos):$timeout(function(){return startAt++,typeText(strings[startAt],0)},endlineWait);else{var nextPos=currPos+1,string=text.substr(0,nextPos);elem.text(string),typeText(text,nextPos)}},delay)}var strings=scope.typeStrings||(elem.text()?[elem.text().trim().replace(/\s+/g," ")]:null);if(!strings)return void $log.info("angular-typed: No strings to type found on element: ",elem[0]);var startAt=attrs.startAt||0,startTimeout=parseInt(attrs.startTimeout)||0,typeSpeed=parseInt(attrs.typeSpeed)||0,backSpeed=parseInt(attrs.backSpeed)||0,removeLine=attrs.removeLine||!0,endlineWait=attrs.endlineWait||250,endBackspace=attrs.endBackspace||!0,cursor=angular.element(document.createElement("span")).addClass("typed-cursor").text("|");elem.empty(),elem.append(cursor),$timeout(function(){return angular.isFunction(scope.startCallback)&&scope.startCallback(),newLine(!0),typeText(strings[startAt],0)},startTimeout)}var _scope={typeStrings:"=?",startCallback:"&",endCallback:"&"},directive={restrict:"AE",replace:!1,scope:_scope,link:_link};return directive});